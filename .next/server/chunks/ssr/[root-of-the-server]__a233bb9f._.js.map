{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///D:/stacky%20patel%20next%20js/GPT%20next%20project/nextauth-demo/src/app/feed/page.js"],"sourcesContent":["\"use client\";\nimport axios from \"axios\";\nimport Link from \"next/link\";\nimport { useState } from \"react\";\nimport useSWR, { mutate } from \"swr\";\n\n\nconst fetcher = (url) => axios.get(url).then((res) => res.data);\n\nexport default function ViewFeed() {\n  const { data, error } = useSWR(\"/api/viewfeed\", fetcher, {\n    revalidateOnFocus: true, // jab user tab pe wapas aata h\n    dedupingInterval: 5000, // 5 sec tak ek hi fetch reuse karega\n  });\n\n  const [message, setMessage] = useState({});\n\n  if (error) return <p className=\"text-center text-red-500\">Error loading blogs ‚ùå</p>;\n  if (!data) return <p className=\"text-center animate-pulse\">Loading blogs...</p>;\n\n  const blogs = data?.allBlogs || [];\n\n\n  async function handleLike(id) {\n    try {\n      const res = await axios.post(`/api/blogs/${id}/like`);\n      if (res.data.success) {\n        setMessage((prev) => ({ ...prev, [id]: \"Liked\" }));\n\n        // Optimistic update for instant UI\n        mutate(\n          \"/api/viewfeed\",\n          {\n            ...data,\n            allBlogs: blogs.map((blog) =>\n              blog._id === id\n                ? {\n                    ...blog,\n                    likes: res.data.blog.likes,\n                    dislikes: res.data.blog.dislikes,\n                  }\n                : blog\n            ),\n          },\n          false\n        );\n      }\n    } catch (err) {\n      console.error(\"Error updating likes:\", err);\n    }\n  }\n\n  // ‚úÖ Dislike\n  async function handleDisLike(id) {\n    try {\n      const res = await axios.post(`/api/blogs/${id}/dislike`);\n      if (res.data.success) {\n        setMessage((prev) => ({ ...prev, [id]: \"Disliked\" }));\n\n        mutate(\n          \"/api/viewfeed\",\n          {\n            ...data,\n            allBlogs: blogs.map((blog) =>\n              blog._id === id\n                ? {\n                    ...blog,\n                    likes: res.data.blog.likes,\n                    dislikes: res.data.blog.dislikes,\n                  }\n                : blog\n            ),\n          },\n          false\n        );\n      }\n    } catch (err) {\n      console.error(\"Error updating dislikes:\", err);\n    }\n  }\n\n  // ‚úÖ Views\n  async function handleView(id) {\n    try {\n      await axios.post(`/api/blogs/${id}/incre`);\n\n      mutate(\n        \"/api/viewfeed\",\n        {\n          ...data,\n          allBlogs: blogs.map((blog) =>\n            blog._id === id ? { ...blog, views: (blog.views ?? 0) + 1 } : blog\n          ),\n        },\n        false\n      );\n    } catch (err) {\n      console.error(\"Error updating views:\", err);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-100 via-gray-200 to-gray-300 py-12 px-6\">\n      {/* Back to Home */}\n      <div className=\"text-center mb-12\">\n        <Link\n          href={\"/\"}\n          className=\"inline-block bg-white/70 backdrop-blur-lg border border-gray-300 text-gray-800 font-medium px-6 py-3 rounded-xl shadow-lg hover:bg-white hover:shadow-xl transition duration-300\"\n        >\n          ‚¨Ö Back to Home\n        </Link>\n      </div>\n\n      {/* Blogs Grid */}\n      <div className=\"max-w-6xl mx-auto\">\n        {blogs.length === 0 ? (\n          <p className=\"text-center text-xl font-medium text-gray-500 animate-pulse\">\n            No blogs found üò¢\n          </p>\n        ) : (\n          <div className=\"grid gap-8 sm:grid-cols-2 lg:grid-cols-3\">\n            {blogs.map((blog, index) => (\n              <div\n                key={blog._id}\n                className=\"relative bg-white/70 backdrop-blur-lg border border-gray-200 rounded-2xl shadow-md p-6 hover:shadow-2xl hover:-translate-y-2 transition transform duration-500\"\n                style={{ animation: `fadeIn 0.6s ease ${index * 0.2}s forwards` }}\n              >\n                {/* Blog Title */}\n                <h3 className=\"text-2xl font-bold text-gray-800 mb-3 hover:text-blue-600 transition\">\n                  {blog.title}\n                </h3>\n\n                {/* Blog Content */}\n                <p className=\"text-gray-600 text-sm leading-relaxed mb-5\">\n                  {blog.content.length > 150\n                    ? blog.content.slice(0, 150) + \"...\"\n                    : blog.content}\n                </p>\n\n                {/* Read More + Views */}\n                <div className=\"flex justify-between items-center mb-4\">\n                  <Link href={`/read/${blog._id}/feedback`}>\n                    <button\n                      onClick={() => handleView(blog._id)}\n                      className=\"text-sm font-semibold text-blue-600 hover:text-blue-800 transition cursor-pointer\"\n                    >\n                      Read More ‚Üí\n                    </button>\n                  </Link>\n                  <span className=\"text-xs text-gray-500\">\n                    üëÅ {blog.views ?? 0}\n                  </span>\n                </div>\n\n                {/* Like / Dislike */}\n                <div className=\"flex justify-start gap-6\">\n                  <button\n                    onClick={() => handleLike(blog._id)}\n                    className=\"cursor-pointer flex items-center gap-2 text-gray-700 hover:text-green-600 transition transform hover:scale-110\"\n                  >\n                    üëç <span>{blog.likes ?? 0}</span>\n                  </button>\n\n                  <button\n                    onClick={() => handleDisLike(blog._id)}\n                    className=\"cursor-pointer flex items-center gap-2 text-gray-700 hover:text-red-600 transition transform hover:scale-110\"\n                  >\n                    üëé <span>{blog.dislikes ?? 0}</span>\n                  </button>\n                </div>\n\n                {/* ‚úÖ Like/Dislike Message */}\n                <div className=\"flex gap-8\">\n                  {message[blog._id] && (\n                    <p\n                      className={`text-sm mt-2 ${\n                        message[blog._id].includes(\"Liked\")\n                          ? \"text-green-600\"\n                          : \"mx-14 text-red-500\"\n                      }`}\n                    >\n                      {message[blog._id]}\n                    </p>\n                  )}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}